<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Há»‡ Thá»‘ng Náº¡p Tiá»n</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>

<div class="container mt-5">
    <h2>ğŸ”¥ ChÃ o má»«ng Ä‘áº¿n vá»›i há»‡ thá»‘ng ğŸ”¥</h2>
    
    <!-- Khu vá»±c Ä‘Äƒng nháº­p -->
    <div id="loginSection">
        <input type="text" id="username" class="form-control mt-2" placeholder="Nháº­p tÃ i khoáº£n">
        <input type="password" id="password" class="form-control mt-2" placeholder="Nháº­p máº­t kháº©u">
        <button onclick="login()" class="btn btn-success mt-2">ÄÄƒng Nháº­p</button>
        <p id="loginError" class="text-danger mt-2 d-none"></p>
    </div>

    <!-- Khu vá»±c thÃ´ng tin ngÆ°á»i dÃ¹ng sau khi Ä‘Äƒng nháº­p -->
    <div id="userSection" class="d-none">
        <h3>Xin chÃ o, <span id="userDisplay"></span> ğŸ‘‹</h3>
        <p>Sá»‘ dÆ°: <strong id="balance">0</strong> VNÄ</p>
        <button onclick="openDeposit()" class="btn btn-primary">Náº¡p Tiá»n</button>
        <button onclick="logout()" class="btn btn-danger">ÄÄƒng Xuáº¥t</button>
    </div>
</div>

<!-- Modal náº¡p tiá»n -->
<div class="modal fade" id="depositModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">ğŸ’° Náº¡p tiá»n</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <input type="text" id="depositCode" class="form-control" placeholder="Nháº­p mÃ£ náº¡p tiá»n">
                <p id="depositError" class="text-danger mt-2 d-none"></p>
            </div>
            <div class="modal-footer">
                <button onclick="confirmDeposit()" class="btn btn-success">XÃ¡c Nháº­n</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        let savedUser = localStorage.getItem("username");
        let isLoggedIn = localStorage.getItem("isLoggedIn");

        if (savedUser && isLoggedIn === "true") {
            showUser(savedUser);
        }
    });

    function login() {
        let username = document.getElementById("username").value.trim();
        let password = document.getElementById("password").value.trim();
        let loginError = document.getElementById("loginError");

        if (username === "admin" && password === "123456") {
            localStorage.setItem("username", username);
            localStorage.setItem("isLoggedIn", "true");

            // Láº¥y sá»‘ dÆ° cÅ© tá»« tÃ i khoáº£n
            let savedBalance = localStorage.getItem(`balance_${username}`) || "0";
            localStorage.setItem("balance", savedBalance);

            showUser(username);
        } else {
            loginError.textContent = "âš ï¸ Sai tÃ i khoáº£n hoáº·c máº­t kháº©u!";
            loginError.classList.remove("d-none");
        }
    }

    function showUser(username) {
        document.getElementById("userDisplay").textContent = username;
        document.getElementById("loginSection").classList.add("d-none");
        document.getElementById("userSection").classList.remove("d-none");

        // Hiá»ƒn thá»‹ sá»‘ dÆ° tá»« localStorage
        let balance = localStorage.getItem("balance") || "0";
        document.getElementById("balance").textContent = balance;
    }

    function openDeposit() {
        let isLoggedIn = localStorage.getItem("isLoggedIn");

        if (isLoggedIn !== "true") {
            alert("âš ï¸ Vui lÃ²ng Ä‘Äƒng nháº­p Ä‘á»ƒ náº¡p tiá»n!");
            return;
        }

        let depositModal = new bootstrap.Modal(document.getElementById("depositModal"));
        depositModal.show();
    }

    function confirmDeposit() {
        let code = document.getElementById("depositCode").value.trim();
        let depositError = document.getElementById("depositError");

        if (code !== "NAPTIEN123") {
            depositError.textContent = "âš ï¸ MÃ£ code khÃ´ng há»£p lá»‡!";
            depositError.classList.remove("d-none");
            return;
        }

        let currentBalance = parseInt(localStorage.getItem("balance") || "0");
        let newBalance = currentBalance + 10;
        localStorage.setItem("balance", newBalance);

        // LÆ°u sá»‘ dÆ° theo tÃ i khoáº£n
        let username = localStorage.getItem("username");
        localStorage.setItem(`balance_${username}`, newBalance);

        document.getElementById("balance").textContent = newBalance;

        depositError.textContent = "âœ… Náº¡p tiá»n thÃ nh cÃ´ng! +10 VNÄ";
        depositError.classList.remove("text-danger");
        depositError.classList.add("text-success");
        depositError.classList.remove("d-none");

        setTimeout(() => {
            let depositModal = bootstrap.Modal.getInstance(document.getElementById('depositModal'));
            depositModal.hide();
        }, 1500);
    }

    function logout() {
        let username = localStorage.getItem("username");

        // XÃ³a tráº¡ng thÃ¡i Ä‘Äƒng nháº­p
        localStorage.removeItem("isLoggedIn");
        localStorage.removeItem("username");

        // Äáº·t sá»‘ dÆ° vá» 0 khi Ä‘Äƒng xuáº¥t
        localStorage.setItem("balance", "0");

        alert("ğŸšª ÄÄƒng xuáº¥t thÃ nh cÃ´ng! Sá»‘ dÆ° vá» 0.");
        location.reload();
    }
</script>

</body>
</html>
